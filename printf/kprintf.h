/*
*
*        _       _________ ______            _______  _______  _______  ______   _______  _______
*       ( \      \__   __/(  ___ \ |\     /|(  ___  )(       )(  ____ \(  ___ \ (  ____ )(  ____ \|\     /|
*       | (         ) (   | (   ) )| )   ( || (   ) || () () || (    \/| (   ) )| (    )|| (    \/| )   ( |
*       | |         | |   | (__/ / | (___) || |   | || || || || (__    | (__/ / | (____)|| (__    | | _ | |
*       | |         | |   |  __ (  |  ___  || |   | || |(_)| ||  __)   |  __ (  |     __)|  __)   | |( )| |
*       | |         | |   | (  \ \ | (   ) || |   | || |   | || (      | (  \ \ | (\ (   | (      | || || |
*       | (____/\___) (___| )___) )| )   ( || (___) || )   ( || (____/\| )___) )| ) \ \__| (____/\| () () |
*       (_______/\_______/|/ \___/ |/     \|(_______)|/     \|(_______/|/ \___/ |/   \__/(_______/(_______)
*
*
*
*/

#pragma once

#include <_types.h>

#ifdef __cplusplus
extern "C" {
#endif

	// Changed to the Thread struct, used by the payloads.
	struct auditinfo_addr {
		/*
		4    ai_auid;
		8    ai_mask;
		24    ai_termid;
		4    ai_asid;
		8    ai_flags;r
		*/
		char useless[184];
	};

	struct ucred {
		uint32_t cr_ref;					// reference count		0x0000
		uint32_t cr_uid;					// effective user id	0x0004
		uint32_t cr_ruid;					// real user id			0x0008
		uint32_t useless2;					// 						0x000C
		uint32_t useless3;					//
		uint32_t cr_rgid;					// real group id
		uint32_t useless4;					//
		void *useless5;						//
		void *useless6;						//
		void *cr_prison;					// jail(2)				0x0030
		void *useless7;						//
		uint32_t useless8;					//
		void *useless9[2];					//
		void *useless10;					//
		struct auditinfo_addr cr_audit;		//
		uint32_t *cr_groups;				// groups
		uint32_t useless12;					//
	};

	struct filedesc {
		void *useless1[3];
		void *fd_rdir;
		void *fd_jdir;
	};

	struct proc {
		char useless[64];
		struct ucred *p_ucred;
		struct filedesc *p_fd;
	};

	struct thread {
		void *useless;
		struct proc *td_proc;
	};

	void *kprintf(struct thread *td);
	void kpayload_copyin(char *buff, int len);

#ifdef __cplusplus
}
#endif